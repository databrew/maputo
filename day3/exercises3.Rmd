---
title: "Exercises"
author: "DataBrew"
output: 
    html_document:
        theme: united
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Wednesday {.tabset .tabset-fade}


#### Violence

1. Read in some data on Mozambican violence.

```{r}
library(tidyverse)
violence <- read_csv("https://github.com/databrew/maputo/blob/master/day3/data/moz.csv?raw=true")
```

2. Click on the data to look at. What does this data appear to be about?

3. Make an object called `x`. This will be all the violent events in Mozambique grouped by the type of event (`event_type`) and then tallied (ie, counted).

4. Look at x. Which type of violence is most common?

5. Make a barplot of the number of different types of violence.

6. Make a histogram of the number of fatalities.

7. Make a new object called `y`. This will be the `violence` data, grouped by `year` and `event_type`, and then summarized to get the total number of fatalities.

8. Plot the total number of fatalities by event type. This should be a barchart of `y` with `year` on the x-axis, the total number of fatalities on the y-axis, and the fill of the bars reflecting the event type.

9. Create an object called `z`. This will be the `violence` data grouped by three variables: (a) year, (b) `admin1` (the province) and (c) the event type. After grouping, use `summarise` to calculate the average number of fatalities for these kinds of incidents.

10. Create a barplot of `z` with `year` on the x-axis, the total number of fatalities on the y-axis, and the fill of the bars reflecting the event type. Use `facet_wrap()` to make different panels for each province.

11. Create an object called `w` which will be the total number of fatalities by year and by province.

12. Make a line chart of `w`, panelled by province.

13. Make a violin chart of the `violence` data in which `year` is on the x-axis and `fatalities` is on the y-axis. You'll need to add `group=year` to within the `aes()` argument.

14. Make the above chart panelled by `admin1`.


### Weather

1. Read in some Mozambican weather data by running the following

```{r, include = FALSE, echo = FALSE}
library(tidyverse)
weather <- read_csv("https://github.com/databrew/maputo/blob/master/day3/data/mozambican_weather.csv?raw=true")
```

```{r, eval = FALSE, echo = TRUE}
library(tidyverse)
weather <- read_csv("https://github.com/databrew/maputo/blob/master/day3/data/mozambican_weather.csv?raw=true")
```

2. Take a look at the top of the data. 

3. Create an object called `x`. This will be the `weather` data, then summarized to tell us the minimum and maximum dates.

4. Create an object called `y`. This will be the `weather` data, then summarized to tell us the maximum `temp_max` and the mimimum `temp_min`.

5. Create an object called `z`. This will be the `weather` data, but filtered to only include the year 2014 and only the district of "MATOLA".

6. Make a plot of `z` with the `date` on the x-axis and the average temperature (`temp`) on the y-axis.

7. Make a plot of `z` showing the distribution of precipitation.

### Switzerland

1. Load up data on health and sociodemographic factors from Switzerland.

```{r}
library(tidyverse)
data('swiss')
swiss <- swiss
```

2. Look at the `cabeÃ§a` of the data. Describe it.

3. Make a chart showing the association between Agriculture rate and Fertility rate. This should be a scatterplot. You'll use `geom_point`.

```{r, eval = FALSE, echo = FALSE}
ggplot(data = swiss,
       aes(x = Agriculture,
           y = Fertility)) +
  geom_point()
```

4. Describe the association.

5. Add the argument `geom_smooth()` to the above chart. What happens?

```{r, eval = FALSE, echo = FALSE}
ggplot(data = swiss,
       aes(x = Agriculture,
           y = Fertility)) +
  geom_point() +
  geom_smooth()
```


6. Run the following code to create a variable called `canton` from the `row.names` of the data:

```{r}
swiss$canton <- row.names(swiss)
```

7. Create an object called `x`. This will be the `swiss` data, but only keeping those cantons which are more than 80% catholic.

```{r, eval = FALSE, echo = FALSE}
x <- swiss %>% filter(Catholic > 80)
```

8. How many rows are in `x`?

9. Go back to your `swiss` data. Is there an association between `Education` and `Catholicism`? Show it in a chart.

10. Create a variable a new variable in `swiss` called `edu`, which indicates whether the canton is highly-educated (at or above the average) or has low education (below the average). Here's the code to do this:

```{r}
swiss <- swiss %>%
  mutate(edu = ifelse(Education >= mean(Education),
                      "High education",
                      "Low education"))
```

11. Create a variable in `swiss` called `fert`. This variable should show whether the canton has high fertility or low fertility. Use the code in the previous question as a guide.

```{r, eval = TRUE, echo = FALSE}
swiss <- swiss %>%
  mutate(fert = ifelse(Fertility >= mean(Fertility),
                      "High fertility",
                      "Low fertility"))
```

12. Create an object called `y`. This will be the `swiss` data, grouped by both your new `edu` and `fert` variables, and then summarized to tell the average infant mortality rate for each subgroup.

```{r, echo = FALSE}
y <- swiss %>%
  group_by(fert, edu) %>%
  summarise(avg = mean(Infant.Mortality))
```

13. Make a barplot of the data in y. Add the argument `position = 'dodge` to within `geom_bar()` to make the bars not stack

```{r, echo = FALSE, eval = FALSE}
ggplot(data = y,
       aes(x = fert, y= avg, fill = edu)) +
  geom_bar(stat = 'identity', position = 'dodge')
```

14. Interpret the above chart. Which group has the highest infant mortality? Which one has the lowest?


15. Arrange the data by infant mortality. Which canton has the lowest?

16. What is the maximum infant mortality for all Swiss canons?

17. What is the maximum infant mortality for canons with high education?

18. What is the average infant mortality for canons with high fertility.

19. Make a plot showing the relationship between fertility (on the x-axis) and infant mortality (on the y-axis).

```{r, echo = FALSE, eval = FALSE}
ggplot(data = swiss,
       aes(x = Fertility,
           y = Infant.Mortality)) +
  geom_point()
```

20. Add `color = edu` to within the `aes()` section of the above chart.

```{r, echo = FALSE, eval = FALSE}
ggplot(data = swiss,
       aes(x = Fertility,
           y = Infant.Mortality,
           color = edu)) +
  geom_point()
```


21. Make a "density" plot of fertility.

22. Create a new variable in `swiss` using `mutate`. The new variable will be named `ag`. This should be whether a canton is very agricultural or not (ie, more than 50%). To do this:

```{r}
swiss <- swiss %>%
  mutate(ag = ifelse(Agriculture > 50, 'Very agricultural',
                     'Not very agricultural'))
```

23. Create an overlapping density chart of infant mortality in which the `fill` shows whether a place is very agricultural or not.

24. Create a new variable in your data called `cath`. This should whether or not a canton is very Catholic (ie, > 50%).

```{r, eval = FALSE, echo = FALSE}
swiss <- swiss %>%
  mutate(cath = ifelse(Catholic > 50, 'Very Catholic', 'Not very Catholic'))
```

25. Create an overlapping density chart of fertility in which the `fill` is whether a place is very Catholic or not.


26. Use `ggridges` to create a ridgeline chart of the distribution of infant mortality by your `cath` variable (here's the code to help)

```{r, eval = FALSE, echo = TRUE}
library(ggridges)
ggplot(data = swiss,
       aes(x = Infant.Mortality,
           y = cath)) +
  ggridges::geom_density_ridges()
```

27. Create a ridgeline chart (like above) showing fertility instead of infant mortality.

```{r, eval = FALSE, echo = FALSE}
library(ggridges)
ggplot(data = swiss,
       aes(x = Fertility,
           y = cath)) +
  ggridges::geom_density_ridges()
```

28. Which areas have more children: Catholic or non-Catholic areas?

29. Use the `cut` function to generate a 4-category categorical variable of the `Education` variable. Call this new variable `educat`. Note that `cut` takes two arguments: first, the variable you are cutting; second, the number of categories you want.

```{r, eval = TRUE, echo = FALSE}
swiss <- swiss %>%
  mutate(educat = cut(Education, 4))
```

30. Make a ridgeline plot of infant mortality's distribution by your new `educat` variable.

```{r, eval = FALSE, echo = FALSE}
ggplot(data = swiss,
       aes(x = Infant.Mortality,
           y = educat)) +
  geom_density_ridges(alpha = 0.6)
```

31. Can you create the following plot? You'll need to add `facet_wrap(~educat)`...

```{r}
ggplot(data = swiss,
       aes(x = Catholic,
           y = Infant.Mortality,
           size = Fertility)) +
  facet_wrap(~educat) +
  geom_point(alpha = 0.6)
```

32. What percentage of high-Catholicism cantons are agricultural?

33. What percentage of low fertility canons are Catholic?

#### Extra


1 Run the following to get some data on "unidades sanitarias" on your computer:
```{r, eval = FALSE}
us <- read_csv("https://raw.githubusercontent.com/databrew/databrew.github.io/master/us.csv")
```

2 Look at the head of the data.

3 Make a scatterplot of the `us` data, with `longitude` on the x-axis and `latitude` on the y-axis.

4 Make an object called `province`. This should be the number of unidades sanitarias per province.

5 Make an object called `district`. This should be the number of unidades sanitarias per district.

6 Create an object called `types`. This should be the number of unidades sanitarias per type

7 Make a barplot of the number of unidades sanitarias by type.

8 Add `coord_flip` to the code to make the plot horizontal instead of vertical.

9 Which type of health post is most common?
 
10 Make another a scatterplot of the `us` data, with `longitude` on the x-axis and `latitude` on the y-axis. But make the color of each point be a reflection of the province



### Time data

1. Load up some data about the weight of chickens over time. Create an object called `frangos`.

```{r}
data('ChickWeight')
frangos <- ChickWeight
```

2 How many columns does the data have?

3 How many rows does the data have?

4 What are the variable types (quantitative/numeric or categorical)?

5 Create a point chart showing weight on the x-axis and time on the y-axis.

6 Create an object called `frango1`. This should be just the data for chicken number 1 (ie, 1 in the `Chick` column).

7 Chart the weight of chicken 1 over time using `geom_point()`

8 Chart the weight of chicken 1 over time using `geom_line()`

9 Chart the weight of chicken 1 over time using `geom_area()`

10 Chart the weight of _all_ chickens over time using `geom_line()`. Make the color of each line different for each chicken.

11 Create an object called `zero`. This should be the frangos only at day 0 (ie, when they are born).

12 Make a histogram of chicken's weights at day 0.

13 Make a density plot of chicken's weights at day 0.

14 Make a violin plot of chicken's weights at day 0. On the x-axis, put the `Diet` type. On the y-axis, put the weight.

15 Add points to the violin plot
